{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/flair/Git-projects/crappylife-frontend/src/app/search/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\nimport { useSearchParams } from \"next/navigation\";\nimport Link from \"next/link\";\nimport Image from \"next/image\";\n\ninterface Article {\n  id: number;\n  title: string;\n  slug: string;\n  cover_image?: string;\n  content?: string;\n}\n\ninterface Event {\n  id: number;\n  title: string;\n  slug: string;\n  image?: string;\n  description?: string;\n  start_date?: string;\n  end_date?: string;\n  location?: string;\n}\n\nfunction getImageUrl(path: string | undefined): string {\n  if (!path) return \"/default.jpg\";\n\n  // Already a full URL (Cloudinary or others)\n  if (path.startsWith(\"http\")) return path;\n\n  // Handle Cloudinary paths like \"image/upload/articles/30gold.webp\"\n  if (path.startsWith(\"image/\")) {\n    return `https://res.cloudinary.com/dvksqgurb/${path}`;\n  }\n\n  // Handle backend-served paths like \"/media/articles/...\"\n  return `${process.env.NEXT_PUBLIC_API_URL}${path.startsWith(\"/\") ? \"\" : \"/\"}${path}`;\n}\n\n\n\n\nexport default function SearchPage() {\n  const searchParams = useSearchParams();\n  const query = searchParams.get(\"q\") || \"\";\n\n  const [results, setResults] = useState<{ articles: Article[]; events: Event[] }>({\n    articles: [],\n    events: [],\n  });\n  const [loading, setLoading] = useState(false);\n\n  const truncateText = (text: string = \"\", length: number) =>\n    text.length > length ? text.slice(0, length) + \"...\" : text;\n\n  useEffect(() => {\n    if (!query) return;\n\n    const fetchResults = async () => {\n      setLoading(true);\n      try {\n        const res = await fetch(\n          `${process.env.NEXT_PUBLIC_API_URL}/api/search/?q=${encodeURIComponent(query)}`\n        );\n        if (!res.ok) throw new Error(\"Failed to fetch search results\");\n        const data = await res.json();\n        setResults({\n          articles: data.articles || [],\n          events: data.events || [],\n        });\n      } catch (error) {\n        console.error(\"Search error:\", error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchResults();\n  }, [query]);\n\n  return (\n    <div className=\"max-w-7xl mx-auto px-4 py-8\">\n      <h1 className=\"text-2xl font-bold mb-6\">\n        Search Results for: <span className=\"text-blue-600\">{query}</span>\n      </h1>\n\n      {loading && <p className=\"text-gray-500\">Searching...</p>}\n\n      {!loading && (\n        <>\n          {/* Articles Section */}\n          <div className=\"mb-10\">\n            <h2 className=\"text-xl font-semibold mb-4\">Articles</h2>\n            {results.articles.length > 0 ? (\n              <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n                {results.articles.map((article) => (\n                  <Link\n                    key={article.id}\n                    href={`/articles/${article.slug}`}\n                    className=\"border rounded-lg overflow-hidden shadow hover:shadow-lg transition block\"\n                  >\n                    <div className=\"relative w-full h-48\">\n                      <Image\n                        src={getImageUrl(article.cover_image)}\n                        alt={article.title}\n                        fill\n                        className=\"object-cover\"\n                      />\n                    </div>\n                    <div className=\"p-4\">\n                      <h3 className=\"text-lg font-semibold\">{article.title}</h3>\n                      {article.content && (\n                        <p className=\"text-sm text-gray-600 mt-2 line-clamp-2\">\n                          {truncateText(article.content, 50)}\n                        </p>\n                      )}\n                    </div>\n                  </Link>\n                ))}\n              </div>\n            ) : (\n              <p className=\"text-gray-500\">No articles found.</p>\n            )}\n          </div>\n\n          {/* Events Section */}\n          <div>\n            <h2 className=\"text-xl font-semibold mb-4\">Events</h2>\n            {results.events.length > 0 ? (\n              <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n                {results.events.map((event) => (\n                  <Link\n                    key={event.id}\n                    href={`/events/${event.slug}`}\n                    className=\"border rounded-lg overflow-hidden shadow hover:shadow-lg transition block\"\n                  >\n                    <div className=\"relative w-full h-48\">\n                      <Image\n                        src={getImageUrl(event.image)}\n                        alt={event.title}\n                        fill\n                        className=\"object-cover\"\n                      />\n                    </div>\n                    <div className=\"p-4\">\n                      <h3 className=\"text-lg font-semibold\">{event.title}</h3>\n                      {event.description && (\n                        <p className=\"text-sm text-gray-600 mt-2 line-clamp-2\">\n                          {truncateText(event.description, 50)}\n                        </p>\n                      )}\n                      {event.start_date && event.end_date && (\n                        <p className=\"mt-2 text-sm text-gray-500\">\n                          üìÖ {new Date(event.start_date).toLocaleDateString()} -{\" \"}\n                          {new Date(event.end_date).toLocaleDateString()}\n                        </p>\n                      )}\n                      {event.location && (\n                        <p className=\"mt-1 text-sm text-gray-500\">üìç {event.location}</p>\n                      )}\n                    </div>\n                  </Link>\n                ))}\n              </div>\n            ) : (\n              <p className=\"text-gray-500\">No events found.</p>\n            )}\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}